import{r as b,j as e,L as D,m as M,S as $}from"./app-C4GB2dFX.js";import{A as I}from"./app-layout-D2Y6azve.js";import{L as O}from"./form-layout-CynCydaI.js";const v=({children:l})=>e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsx("div",{className:"relative z-10 w-full flex justify-center",children:l})]}),L=({open:l,onClose:i,seguimiento:a,historiaId:n,modalFields:d,view:s})=>{console.log("Modal fields:",d);const m=d.reduce((r,t)=>(r[t[0]]=(a==null?void 0:a[t[0]])??(t[2]==="date"?new Date().toISOString().slice(0,10):""),r),{}),{data:o,setData:c,post:p,put:y,reset:g}=M({[`id_${s}`]:n,...m});b.useEffect(()=>{const r=d.reduce((t,x)=>(t[x[0]]=(a==null?void 0:a[x[0]])??(x[2]==="date"?new Date().toISOString().slice(0,10):""),t),{});c({[`id_${s}`]:n,...r})},[a,d]);const j=r=>{r.preventDefault();const t=`${s}.seguimientos`;a?y(route(`${t}.update`,a.id),{data:o,onSuccess:()=>{g(),i()}}):p(route(`${t}.store`),{data:o,onSuccess:()=>{g(),i()}})};return l?e.jsx(v,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full md:w-3/4 max-w-4xl",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:a?"Editar Seguimiento":"Nuevo Seguimiento"}),e.jsxs("form",{onSubmit:j,className:"flex flex-col gap-3",children:[d.map(r=>r[2]==="textarea"?e.jsx("textarea",{value:o[r[0]],onChange:t=>c(r[0],t.target.value),className:"w-full min-h-[80px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:r[1],required:r[3]??!1},r[0]):e.jsx("input",{type:r[2],value:o[r[0]],onChange:t=>c(r[0],t.target.value),className:"rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:r[1],required:r[3]??!1},r[0])),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Guardar"})]})]})]})}):null},G=({form_data:l,formFields:i,modalFields:a=[],action:n,custom_title:d,view:s,title:m,queryparams:o,width_form:c,toggleOptions:p,apiConfig:y,seguimientos:g=[]})=>{const[j,r]=b.useState(!1),[t,x]=b.useState(null),[S,N]=b.useState(!1),[k,w]=b.useState(null),E=(l==null?void 0:l[`id_${s}`])??Number(window.location.pathname.split("/").pop()??0),f=n!=="info"&&n!=="delete";console.log("FormPage modalFields:",a);const C=()=>{k&&$.delete(route(`${s}.seguimientos.destroy`,k),{onSuccess:()=>{N(!1),w(null)}})};return e.jsxs(I,{breadcrumbs:[{title:m,href:s}],children:[e.jsx(D,{title:m}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsx(O,{form_data:l,formFields:i,action:n,custom_title:d,view:s,width_form:c,queryparams:o,toggleOptions:p,apiConfig:y}),n!=="create"&&e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 p-4 shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"SEGUIMIENTO:"}),f&&e.jsx("button",{onClick:()=>{x(null),r(!0)},className:"bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 transition",children:"+ Agregar"})]}),e.jsx("div",{className:"grid gap-3 max-h-64 overflow-y-auto",children:g.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay seguimientos registrados."}):g.map(u=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm flex justify-between items-start",children:[e.jsx("div",{children:a.map(h=>u[h[0]]?e.jsxs("p",{className:`text-sm ${h[2]==="textarea"?"font-medium":"text-gray-600 dark:text-gray-300"}`,children:[h[1],": ",u[h[0]]]},h[0]):null)}),f&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>{x(u),r(!0)},className:"px-2 py-1 rounded bg-yellow-500 text-white text-xs hover:bg-yellow-600 transition",children:"Editar"}),e.jsx("button",{onClick:()=>{w(u.id),N(!0)},className:"px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600 transition",children:"Eliminar"})]})]},u.id))})]}),e.jsx(L,{open:j,onClose:()=>r(!1),seguimiento:t,historiaId:E,modalFields:a,view:s}),S&&e.jsx(v,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Confirmar Eliminación"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"¿Estás seguro de que deseas eliminar este seguimiento?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{onClick:C,className:"px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600",children:"Eliminar"})]})]})})]})]})};export{G as F};
