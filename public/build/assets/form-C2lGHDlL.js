import{r as c,j as e,L as C,m as E,S as D}from"./app-ByYHrOUV.js";import{A as O}from"./app-layout-CD5Lm8eP.js";import{L as I}from"./form-layout-cGUCp3Ht.js";import"./button-BuBdBdGP.js";import"./index-DvQ3WTEQ.js";import"./index-CMxVBQyz.js";import"./transition-CI6ZHC8s.js";import"./form-fields-LO_Dtlq6.js";import"./label-C95uH9xq.js";import"./index-DdABwvE6.js";const j=({children:r})=>e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsx("div",{className:"relative z-10 w-full flex justify-center",children:r})]}),M=({open:r,onClose:d,seguimiento:t,historiaId:o})=>{const{data:l,setData:i,post:x,put:g,reset:n}=E({detalle:"",tratamiento:"",observaciones:"",fecha:new Date().toISOString().slice(0,10),id_historia_clinica:o});c.useEffect(()=>{t?i({detalle:t.detalle||"",tratamiento:t.tratamiento||"",observaciones:t.observaciones||"",fecha:t.fecha||new Date().toISOString().slice(0,10),id_historia_clinica:o}):n({detalle:"",tratamiento:"",observaciones:"",fecha:new Date().toISOString().slice(0,10),id_historia_clinica:o})},[t,r]);const m=a=>{a.preventDefault(),t?g(route("seguimientos.update",t.id),{onSuccess:()=>{n(),d()}}):x(route("seguimientos.store"),{onSuccess:()=>{n(),d()}})};return r?e.jsx(j,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full md:w-3/4 max-w-4xl",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:t?"Editar Seguimiento":"Nuevo Seguimiento"}),e.jsxs("form",{onSubmit:m,className:"flex flex-col gap-3",children:[e.jsx("textarea",{value:l.detalle,onChange:a=>i("detalle",a.target.value),className:"w-full min-h-[100px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:"Detalle del seguimiento...",required:!0}),e.jsx("textarea",{value:l.tratamiento,onChange:a=>i("tratamiento",a.target.value),className:"w-full min-h-[80px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:"Tratamiento (opcional)"}),e.jsx("textarea",{value:l.observaciones,onChange:a=>i("observaciones",a.target.value),className:"w-full min-h-[80px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:"Observaciones (opcional)"}),e.jsx("input",{type:"date",value:l.fecha,onChange:a=>i("fecha",a.target.value),className:"rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2"}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Guardar"})]})]})]})}):null},L=({form_data:r,formFields:d,action:t,custom_title:o,view:l,title:i,queryparams:x,width_form:g,toggleOptions:n,apiConfig:m,seguimientos:a=[]})=>{const[v,h]=c.useState(!1),[k,b]=c.useState(null),[w,u]=c.useState(!1),[p,y]=c.useState(null),N=Number(window.location.pathname.split("/").pop()),f=t!=="info"&&t!=="delete",S=()=>{p&&D.delete(route("seguimientos.destroy",p),{onSuccess:()=>{u(!1),y(null)}})};return e.jsxs(O,{breadcrumbs:[{title:i,href:l}],children:[e.jsx(C,{title:i}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsx(I,{form_data:r,formFields:d,action:t,custom_title:o,view:l,width_form:g,queryparams:x,toggleOptions:n,apiConfig:m}),l==="historia_clinica"&&t!=="create"&&e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 p-4 shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"SEGUIMIENTO:"}),f&&e.jsx("button",{onClick:()=>{b(null),h(!0)},className:"bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 transition",children:"+ Agregar"})]}),e.jsx("div",{className:"grid gap-3 max-h-64 overflow-y-auto",children:a.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay seguimientos registrados."}):a.map(s=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.detalle}),s.tratamiento&&e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:["Tratamiento: ",s.tratamiento]}),s.observaciones&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Obs: ",s.observaciones]}),e.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:s.fecha})]}),f&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>{b(s),h(!0)},className:"px-2 py-1 rounded bg-yellow-500 text-white text-xs hover:bg-yellow-600 transition",children:"Editar"}),e.jsx("button",{onClick:()=>{y(s.id),u(!0)},className:"px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600 transition",children:"Eliminar"})]})]},s.id))})]}),e.jsx(M,{open:v,onClose:()=>h(!1),seguimiento:k,historiaId:(r==null?void 0:r.id)||N}),w&&e.jsx(j,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Confirmar Eliminación"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"¿Estás seguro de que deseas eliminar este seguimiento?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{onClick:S,className:"px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600",children:"Eliminar"})]})]})})]})]})};function U(r){return e.jsx(L,{...r})}export{U as default};
