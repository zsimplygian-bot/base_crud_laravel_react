import{r as h,j as e,L as D,m as $,S as I}from"./app-3Uj3D6sX.js";import{A as M}from"./app-layout-DO31fV2f.js";import{L as O}from"./form-layout-CvF3S8fi.js";const f=({children:n})=>e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsx("div",{className:"relative z-10 w-full flex justify-center",children:n})]}),q=({open:n,onClose:x,seguimiento:a,historiaId:l,modalFields:d,view:s})=>{const b=d.reduce((t,r)=>(t[r.name]=(a==null?void 0:a[r.name])??(r.type==="date"?new Date().toISOString().slice(0,10):""),t),{}),{data:o,setData:c,post:p,put:y,reset:g}=$({[`id_${s}`]:l,...b});h.useEffect(()=>{const t=d.reduce((r,i)=>(r[i.name]=(a==null?void 0:a[i.name])??(i.type==="date"?new Date().toISOString().slice(0,10):""),r),{});c({[`id_${s}`]:l,...t})},[a,d]);const j=t=>{t.preventDefault();const r=`${s}.seguimientos`;a?y(route(`${r}.update`,a.id),{data:o,onSuccess:()=>{g(),x()}}):p(route(`${r}.store`),{data:o,onSuccess:()=>{g(),x()}})};return n?e.jsx(f,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full md:w-3/4 max-w-4xl",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:a?"Editar Seguimiento":"Nuevo Seguimiento"}),e.jsxs("form",{onSubmit:j,className:"flex flex-col gap-3",children:[d.map(t=>t.type==="textarea"?e.jsx("textarea",{value:o[t.name],onChange:r=>c(t.name,r.target.value),className:"w-full min-h-[80px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:t.label,required:t.required},t.name):e.jsx("input",{type:t.type,value:o[t.name],onChange:r=>c(t.name,r.target.value),className:"rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:t.label,required:t.required},t.name)),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Guardar"})]})]})]})}):null},G=({form_data:n,formFields:x,modalFields:a=[],action:l,custom_title:d,view:s,title:b,queryparams:o,width_form:c,toggleOptions:p,apiConfig:y,seguimientos:g=[]})=>{const[j,t]=h.useState(!1),[r,i]=h.useState(null),[S,N]=h.useState(!1),[k,w]=h.useState(null),E=(n==null?void 0:n[`id_${s}`])??Number(window.location.pathname.split("/").pop()??0),v=l!=="info"&&l!=="delete",C=()=>{k&&I.delete(route(`${s}.seguimientos.destroy`,k),{onSuccess:()=>{N(!1),w(null)}})};return e.jsxs(M,{breadcrumbs:[{title:b,href:s}],children:[e.jsx(D,{title:b}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsx(O,{form_data:n,formFields:x,action:l,custom_title:d,view:s,width_form:c,queryparams:o,toggleOptions:p,apiConfig:y}),l!=="create"&&e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 p-4 shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"SEGUIMIENTO:"}),v&&e.jsx("button",{onClick:()=>{i(null),t(!0)},className:"bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 transition",children:"+ Agregar"})]}),e.jsx("div",{className:"grid gap-3 max-h-64 overflow-y-auto",children:g.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay seguimientos registrados."}):g.map(u=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm flex justify-between items-start",children:[e.jsx("div",{children:a.map(m=>u[m.name]?e.jsxs("p",{className:`text-sm ${m.type==="textarea"?"font-medium":"text-gray-600 dark:text-gray-300"}`,children:[m.label,": ",u[m.name]]},m.name):null)}),v&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>{i(u),t(!0)},className:"px-2 py-1 rounded bg-yellow-500 text-white text-xs hover:bg-yellow-600 transition",children:"Editar"}),e.jsx("button",{onClick:()=>{w(u.id),N(!0)},className:"px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600 transition",children:"Eliminar"})]})]},u.id))})]}),e.jsx(q,{open:j,onClose:()=>t(!1),seguimiento:r,historiaId:E,modalFields:a,view:s}),S&&e.jsx(f,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Confirmar Eliminación"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"¿Estás seguro de que deseas eliminar este seguimiento?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{onClick:C,className:"px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600",children:"Eliminar"})]})]})})]})]})};export{G as F};
