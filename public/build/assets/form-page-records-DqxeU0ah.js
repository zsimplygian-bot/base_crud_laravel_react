import{r as h,j as e,L as D,m as M,S as $}from"./app-CEZSqbSZ.js";import{A as I}from"./app-layout-CvscbXJf.js";import{L as O}from"./form-layout-ixu3Wt4r.js";const S=({children:n})=>e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsx("div",{className:"relative z-10 w-full flex justify-center",children:n})]}),q=({open:n,onClose:c,seguimiento:t,historiaId:l,modalFields:o,view:s})=>{const p=o.reduce((a,r)=>(a[r.name]=(t==null?void 0:t[r.name])??(r.type==="date"?new Date().toISOString().slice(0,10):""),a),{}),{data:i,setData:x,post:y,put:j,reset:g}=M({[`id_${s}`]:l,...p});h.useEffect(()=>{const a=o.reduce((r,d)=>(r[d.name]=(t==null?void 0:t[d.name])??(d.type==="date"?new Date().toISOString().slice(0,10):""),r),{});x({[`id_${s}`]:l,...a})},[t,o]);const w=a=>{a.preventDefault();const b=`${{historia_clinica:"HistoriaClinica",cita:"Cita",vacuna:"Vacuna"}[s]??s}.seguimientos`;t?j(route(`${b}.update`,t.id),{data:i,onSuccess:()=>{g(),c()}}):y(route(`${b}.store`),{data:i,onSuccess:()=>{g(),c()}})};return n?e.jsx(S,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full md:w-3/4 max-w-4xl",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:t?"Editar Seguimiento":"Nuevo Seguimiento"}),e.jsxs("form",{onSubmit:w,className:"flex flex-col gap-3",children:[o.map(a=>a.type==="textarea"?e.jsx("textarea",{value:i[a.name],onChange:r=>x(a.name,r.target.value),className:"w-full min-h-[80px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:a.label,required:a.required},a.name):e.jsx("input",{type:a.type,value:i[a.name],onChange:r=>x(a.name,r.target.value),className:"rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2",placeholder:a.label,required:a.required},a.name)),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Guardar"})]})]})]})}):null},z=({form_data:n,formFields:c,modalFields:t=[],action:l,custom_title:o,view:s,title:p,queryparams:i,width_form:x,toggleOptions:y,apiConfig:j,seguimientos:g=[]})=>{const[w,a]=h.useState(!1),[r,d]=h.useState(null),[b,N]=h.useState(!1),[k,v]=h.useState(null),C=(n==null?void 0:n[`id_${s}`])??Number(window.location.pathname.split("/").pop()??0),f=l!=="info"&&l!=="delete",E=()=>{k&&$.delete(route(`${s}.seguimientos.destroy`,k),{onSuccess:()=>{N(!1),v(null)}})};return e.jsxs(I,{breadcrumbs:[{title:p,href:s}],children:[e.jsx(D,{title:p}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsx(O,{form_data:n,formFields:c,action:l,custom_title:o,view:s,width_form:x,queryparams:i,toggleOptions:y,apiConfig:j}),l!=="create"&&e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 p-4 shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"SEGUIMIENTO:"}),f&&e.jsx("button",{onClick:()=>{d(null),a(!0)},className:"bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 transition",children:"+ Agregar"})]}),e.jsx("div",{className:"grid gap-3 max-h-64 overflow-y-auto",children:g.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay seguimientos registrados."}):g.map(u=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm flex justify-between items-start",children:[e.jsx("div",{children:t.map(m=>u[m.name]?e.jsxs("p",{className:`text-sm ${m.type==="textarea"?"font-medium":"text-gray-600 dark:text-gray-300"}`,children:[m.label,": ",u[m.name]]},m.name):null)}),f&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>{d(u),a(!0)},className:"px-2 py-1 rounded bg-yellow-500 text-white text-xs hover:bg-yellow-600 transition",children:"Editar"}),e.jsx("button",{onClick:()=>{v(u.id),N(!0)},className:"px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600 transition",children:"Eliminar"})]})]},u.id))})]}),e.jsx(q,{open:w,onClose:()=>a(!1),seguimiento:r,historiaId:C,modalFields:t,view:s}),b&&e.jsx(S,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Confirmar Eliminación"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"¿Estás seguro de que deseas eliminar este seguimiento?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{onClick:E,className:"px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600",children:"Eliminar"})]})]})})]})]})};export{z as F};
