import{r as d,j as e,L as $,m as O,S as L}from"./app-BiuwV56C.js";import{A}from"./app-layout-DcumNfSD.js";import{L as q}from"./form-layout-C3ZtEKqb.js";const E=({children:n})=>e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40"}),e.jsx("div",{className:"relative z-10 w-full flex justify-center",children:n})]}),z=({open:n,onClose:b,seguimiento:a,historiaId:i,modalFields:o,view:l})=>{const p=d.useMemo(()=>(o||[]).reduce((t,r)=>{const s=r.name||r[0],c=r.type||r[2];return t[s]=(a==null?void 0:a[s])??(c==="date"?new Date().toISOString().slice(0,10):""),t},{}),[o,a]),{data:m,setData:y,post:f,put:N,reset:j}=O({[`id_${l}`]:i,...p});d.useEffect(()=>{console.log("Modal fields:",o)},[o]);const k=t=>{t.preventDefault();const r=`${l}.seguimientos`,s={data:m,onSuccess:()=>{j(),b()}};a?N(route(`${r}.update`,a.id),s):f(route(`${r}.store`),s)};return n?e.jsx(E,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full md:w-3/4 max-w-4xl",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:a?"Editar Seguimiento":"Nuevo Seguimiento"}),e.jsxs("form",{onSubmit:k,className:"flex flex-col gap-3",children:[o.map(t=>{const r=t.name||t[0],s=t.label||t[1],c=t.type||t[2],x=t.required??!1;return c==="textarea"?e.jsx("textarea",{value:m[r]??"",onChange:g=>y(r,g.target.value),placeholder:s,required:x,className:"w-full min-h-[80px] rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2"},r):e.jsx("input",{type:c,value:m[r]??"",onChange:g=>y(r,g.target.value),placeholder:s,required:x,className:"rounded border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white p-2"},r)}),e.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:b,className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Guardar"})]})]})]})}):null},R=({form_data:n,formFields:b,modalFields:a=[],action:i,custom_title:o,view:l,title:p,queryparams:m,width_form:y,toggleOptions:f,apiConfig:N,seguimientos:j=[]})=>{const[k,t]=d.useState(!1),[r,s]=d.useState(null),[c,x]=d.useState(!1),[g,v]=d.useState(null),C=(n==null?void 0:n[`id_${l}`])??Number(window.location.pathname.split("/").pop()??0),S=i!=="info"&&i!=="delete";d.useEffect(()=>{console.log("FormPage modalFields:",a)},[a]);const M=()=>{g&&L.delete(route(`${l}.seguimientos.destroy`,g),{onSuccess:()=>{x(!1),v(null)}})};return e.jsxs(A,{breadcrumbs:[{title:p,href:l}],children:[e.jsx($,{title:p}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsx(q,{form_data:n,formFields:b,action:i,custom_title:o,view:l,width_form:y,queryparams:m,toggleOptions:f,apiConfig:N}),i!=="create"&&e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-gray-900 border-gray-200 dark:border-gray-700 p-4 shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"SEGUIMIENTO:"}),S&&e.jsx("button",{onClick:()=>{s(null),t(!0)},className:"bg-indigo-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-indigo-700 transition",children:"+ Agregar"})]}),e.jsx("div",{className:"grid gap-3 max-h-64 overflow-y-auto",children:j.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No hay seguimientos registrados."}):j.map(h=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 shadow-sm flex justify-between items-start",children:[e.jsx("div",{children:a.map(u=>{const w=u.name||u[0],D=u.label||u[1],I=u.type||u[2];return h[w]?e.jsxs("p",{className:`text-sm ${I==="textarea"?"font-medium":"text-gray-600 dark:text-gray-300"}`,children:[D,": ",h[w]]},w):null})}),S&&e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("button",{onClick:()=>{s(h),t(!0)},className:"px-2 py-1 rounded bg-yellow-500 text-white text-xs hover:bg-yellow-600 transition",children:"Editar"}),e.jsx("button",{onClick:()=>{v(h.id),x(!0)},className:"px-2 py-1 rounded bg-red-500 text-white text-xs hover:bg-red-600 transition",children:"Eliminar"})]})]},h.id))})]}),e.jsx(z,{open:k,onClose:()=>t(!1),seguimiento:r,historiaId:C,modalFields:a,view:l}),c&&e.jsx(E,{children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:"Confirmar Eliminación"}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:"¿Estás seguro de que deseas eliminar este seguimiento?"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 rounded bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-white",children:"Cancelar"}),e.jsx("button",{onClick:M,className:"px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600",children:"Eliminar"})]})]})})]})]})};export{R as F};
